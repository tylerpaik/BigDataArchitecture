<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Rocket League Pro League Stat Tracker</title>
    <link rel="stylesheet" type="text/css" href="rlBettingStyle.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>

    <div class="tabs">
      <button class="tablink" onclick="openTab('home')">Home</button>
      <button class="tablink" onclick="openTab('visualizations')">Player Stat Visualization</button>
      <button class="tablink" onclick="openTab('predictions')">Betting Line Prediction</button>
      
    </div>
    <!-- the idea here is to make automated tables for the last NBA matches displaying basic match stats, include team logos and diplay, make the tables look like padlets?, -->
    <!-- suggesting dealing with data part first & then updating design -->
    <div id="home" class="tabcontent">
      <h1>Welcome to the Rocket League Pro League Stat Tracker</h1>
      <p>This website provides interactive visualizations and statistical analysis of professional Rocket League results. Please select a tab to get started.</p>

      <h2>Latest Rocket League Matches</h2>
      <table id="latest-matches">
        <tr>
          <th>Date</th>
          <th>Teams</th>
          <th>Result</th>
          <th>Player Scores</th>
          <th>MVP</th>
        </tr>
      </table>
    </div>

    <div id="visualizations" class="tabcontent" style="display: none">
      <div class = "searchbar">
        <input type="text" placeholder="Player Tag">
        <button type="submit">Search</button>
      </div>
      <div class="container">
        <div class="row mt-5">
            <div class="col text-center">
                <h1>Welcome to the Rocket League Statistics Page!</h1>
            </div>
        </div>
        <div class="row mt-5">
            <div class="col text-center">
                <button id="statsBtn" class="btn btn-primary">Stats</button>
                <button id="compareBtn" class="btn btn-secondary">Compare</button>
            </div>
        </div>
        <div class="row mt-5" id="playerSearch" style="display: none;">
            <div class="col text-center">
                <input type="text" id="playerName" class="form-control" placeholder="Enter player name">
                <button id="visualizeBtn" class="btn btn-primary mt-3">Visualize</button>
            </div>
        </div>
        <div class="row mt-5" id="teamSearch" style="display: none;">
            <div class="col text-center">
                <select id="team1" class="form-select">
                    <option selected>Select team 1</option>
                </select>
                <select id="team2" class="form-select mt-3">
                    <option selected>Select team 2</option>
                </select>
                <button id="compareVisualizeBtn" class="btn btn-primary mt-3">Visualize</button>
            </div>
        </div>
        <div class="row mt-5" id="charts" style="display: none;">
            <div class="col text-center">
                <img id="chartImage" src="" alt="Player Stats Charts">
            </div>
        </div>
      </div>
    </div>
    

    <div id="predictions" class="tabcontent" style="display: none;">
      <div class = "searchbar">
        <input type="text" placeholder="Player Tag">
        <input type="text" placeholder="Line">
        <select id="stat" name="stat">
          <option value="goals">Goals</option>
          <option value="assists">Assists</option>
          <option value="saves">Saves</option>
          <option value="demos">Demos</option>
        </select>
        <button type="submit" margin-right="3px">Search</button>
      </div>
      <h1>Betting Line Prediction</h1>
      <p>Coming soon...</p>
    </div>


    <script>
      $(document).ready(function () {
          $("#statsBtn").click(function () {
              $("#teamSearch").hide();
              $("#playerSearch").show();
          });

          $("#compareBtn").click(function () {
              $("#playerSearch").hide();
              $("#teamSearch").show();
              $.getJSON('/teams', function (data) {
                  const team_names = data.team_names;
                  for (let i = 0; i < team_names.length; i++) {
                      $("#team1, #team2").append(`<option value="${team_names[i]}">${team_names[i]}</option>`);
                  }
              });
          });

          $("#visualizeBtn").click(function () {
              let playerName = $("#playerName").val();
              if (playerName) {
                  $.post('/visualize_player', { player_name: playerName }, function (data) {
                      $("#charts").show();
                      $("#chartImage").attr("src", "data:image/png;base64," + data.image_data);
                  });
              } else {
                  alert("Please enter a player name.");
              }
          });
      });
    </script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="visualization.js"></script>
    <script src="tabs.js"></script>
  </body>
</html>
